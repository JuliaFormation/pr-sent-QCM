@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

/* ===== Thème clair ===== */
:root{
  --primary:#6080bf; --primary-2:#8dcef4; --accent:#fde6bb;
  --bg:#f5f8ff; --bg-2:#ffffff;
  --surface:#ffffff; --surface-2:#ffffff;
  --text:#0e1420; --muted:#5b6472;
  --border:rgba(14,20,32,.10); --shadow:rgba(46,74,117,.18);
  --success:#27ae60; --danger:#e74c3c;
  --ring: color-mix(in oklab, var(--primary) 40%, transparent);
  --ring-2: color-mix(in oklab, var(--primary-2) 40%, transparent);
}
/* Sombre */
:root[data-theme="dark"]{
  --bg:#0a0b0d; --bg-2:#0f1115;
  --surface:rgba(22,24,29,.86); --surface-2:rgba(18,20,25,.92);
  --text:#eef1f6; --muted:#b8bfca;
  --border:rgba(255,255,255,.08); --shadow:rgba(0,0,0,.45);
  --success:#41d17d; --danger:#ff6b6b;
}

/* ===== Base ===== */
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{
  font-family:Poppins,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,"Helvetica Neue";
  color:var(--text); line-height:1.55;
  background:
    radial-gradient(1200px 600px at 15% -10%, color-mix(in oklab, var(--primary-2) 30%, transparent), transparent 60%),
    radial-gradient(1000px 500px at 100% 0%, color-mix(in oklab, var(--primary) 28%, transparent), transparent 60%),
    linear-gradient(180deg, var(--bg), var(--bg-2));
  min-height:100dvh;
}

.app-header,.app-footer,.app{max-width:980px;margin:0 auto;padding:18px 20px}
.app-header{display:flex;align-items:center;justify-content:space-between}
.header-left{display:flex;gap:10px;align-items:center}
.app-header h1{margin:0;font-size:clamp(22px,3vw,30px)}

.screen{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:22px;
  padding:22px;
  box-shadow:0 22px 50px var(--shadow);
  animation:screenIn .38s cubic-bezier(.22,.75,.16,1) both;
}
@keyframes screenIn{from{opacity:0;transform:translateY(10px) scale(.985)}to{opacity:1;transform:translateY(0) scale(1)}}
[hidden]{display:none!important}

/* ===== Uploader / Config ===== */
.uploader{display:grid;gap:8px;margin-top:6px}
.uploader label{font-weight:600}
#csvFile{
  padding:12px 14px;border-radius:14px;border:1px solid var(--border);
  background:var(--surface-2);color:var(--text);
  transition:box-shadow .2s,border-color .2s,transform .06s;
}
#csvFile:focus{box-shadow:0 0 0 4px var(--ring);border-color:color-mix(in oklab,var(--primary) 35%, var(--border))}
.hint{color:var(--muted);font-size:14px;margin:4px 0 0}
.import-actions{margin-top:16px}
.import-summary{margin-top:14px;color:var(--muted);font-size:14px}

.final-message-card{
  margin-top:18px;background:var(--surface);
  border:1px solid var(--border);border-radius:18px;padding:14px;
  box-shadow:0 16px 36px var(--shadow);
}
.final-message-card h3{margin:0 0 6px 0;font-size:16px}
.final-row{display:grid;gap:8px;margin-top:12px}
.final-label{font-weight:700}
.final-num{width:120px;padding:10px;border-radius:12px;border:1px solid var(--border);background:var(--surface-2)}
.final-row textarea,.final-row input[type="text"],.final-row input[type="url"]{
  width:100%;padding:11px 12px;border-radius:12px;border:1px solid var(--border);background:var(--surface-2);
  transition:box-shadow .2s,border-color .2s
}
.final-row textarea:focus,.final-row input[type="text"]:focus,.final-row input[type="url"]{
  box-shadow:0 0 0 4px var(--ring-2);border-color:color-mix(in oklab,var(--primary-2) 40%, var(--border))
}
.final-inline{display:grid;grid-template-columns:1fr 1fr;gap:8px}

/* Preview image config */
.img-preview{display:grid;gap:6px;justify-items:start}
.img-preview img{max-width:240px;max-height:170px;border-radius:12px;border:1px solid var(--border);box-shadow:0 12px 26px var(--shadow);animation:fadeIn .25s ease both}
.img-preview-hint{color:var(--muted);font-size:12px}
@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}

/* Bannière (masquée en reader-mode) */
.reader-banner{
  margin:8px 0 10px; padding:10px 12px; border-radius:12px;
  border:1px dashed var(--border);
  background: color-mix(in oklab, var(--primary-2) 18%, var(--bg-2));
  color: var(--text); font-size:14px;
}
.reader-mode #readerBanner{ display:none !important; }

/* ===== Boutons ===== */
.btn{
  border:1px solid var(--border); background:var(--surface-2); color:var(--text);
  padding:12px 16px; border-radius:14px; font-weight:700; cursor:pointer;
  box-shadow:0 12px 26px var(--shadow);
  transition:transform .08s, box-shadow .2s, background .2s, border-color .2s, opacity .2s;
}
.btn:hover{transform:translateY(-1px);box-shadow:0 16px 34px var(--shadow)}
.btn:active{transform:translateY(0) scale(.98)}
.btn:disabled{opacity:.5;cursor:not-allowed}
.btn.primary{
  background:linear-gradient(180deg, color-mix(in oklab, var(--primary-2) 80%, white 20%), var(--primary));
  color:#0b1020;border-color:transparent;
}
.btn.success{
  position:relative;overflow:hidden;
  background:linear-gradient(180deg, color-mix(in oklab, var(--success) 85%, white 15%), var(--success));
  color:#03140a;border-color:transparent;
}
.btn.ghost{background:transparent;border-color:var(--border)}
.btn:focus,#themeToggle:focus,.answer-btn:focus,#csvFile:focus,.short-answer-input:focus{outline:none;box-shadow:0 0 0 4px var(--ring)}

/* ===== Questions ===== */
.question-header{display:flex;flex-direction:column;gap:10px;margin-bottom:14px}
#question-title{margin:0;font-size:clamp(18px,2.6vw,24px)}
.progress{font-size:13px;color:var(--muted)}
.answers{display:grid;gap:14px;margin:8px 0 16px}
.answer-btn{
  width:100%;text-align:left;padding:16px;border-radius:16px;border:1px solid var(--border);
  background:var(--surface-2);color:var(--text);font-weight:600;cursor:pointer;
  box-shadow:0 10px 24px var(--shadow);
  transform:translateY(0); transition:transform .12s ease, box-shadow .2s, border-color .2s, background .2s;
  font-size:16px;
}
.answer-btn:hover{transform:translateY(-2px);box-shadow:0 16px 34px var(--shadow)}
.answer-btn:active{transform:translateY(0) scale(.985)}
.answer-btn.selected{
  outline:2px solid var(--primary);
  background:linear-gradient(0deg, color-mix(in oklab, var(--primary) 16%, transparent), transparent), var(--surface-2);
  border-color:var(--primary);
}

/* Champ RC */
.short-answer-input{
  width:100%;padding:13px 14px;border-radius:14px;border:1px solid var(--border);
  background:var(--surface-2);color:var(--text);font-size:16px;box-shadow:0 10px 24px var(--shadow)
}

/* ===== Résultats ===== */
#results-title{margin-top:0}
.results-top{display:grid;grid-template-columns:260px 1fr;gap:16px;align-items:start;margin:8px 0 18px}
.score-wrap{display:flex;justify-content:flex-start} /* aligné à gauche */
.score{
  font-size:clamp(30px,6vw,46px);font-weight:800;
  background:linear-gradient(180deg, #fff, color-mix(in oklab, #fff 60%, var(--primary-2) 40%));
  border:1px solid var(--border);border-radius:20px;padding:14px 20px;
  box-shadow:0 22px 50px var(--shadow);
  animation:pop .36s cubic-bezier(.22,.75,.16,1) both;
}
@keyframes pop{from{transform:scale(.96);opacity:0}to{transform:scale(1);opacity:1}}

.final-card{
  background:linear-gradient(180deg, #fff, color-mix(in oklab, #fff 70%, var(--primary-2) 30%));
  border:1px solid var(--border);border-radius:18px;padding:12px;
  box-shadow:0 18px 46px var(--shadow);
  display:grid;gap:8px; animation:fadeIn .28s ease both;
}
.final-msg-text{ font-size:clamp(16px,2vw,20px); line-height:1.5; margin:0; }
.final-msg-link{ font-weight:700; text-decoration:underline; color:var(--primary) }
.final-msg-img{ max-width:75%; height:auto; border-radius:12px; border:1px solid var(--border); box-shadow:0 12px 26px var(--shadow); display:block; margin:8px auto 0; }

.results-list{display:grid;gap:14px}
.result-question{background:var(--surface-2);border:1px solid var(--border);border-radius:16px;padding:12px 14px;animation:fadeIn .25s ease both}
.result-question h3{margin:0 0 8px 0;font-size:16px}
.q-status-cross{color:var(--danger);font-weight:900;margin-left:6px}
.q-status-check{color:var(--success);font-weight:900;margin-left:6px}
.result-question ul{margin:0;padding-left:20px;display:grid;gap:6px}
.result-question li{list-style:disc}
.result-question li.correct{color:var(--success);font-weight:700}
.result-question li.wrong{color:var(--danger);font-weight:700;text-decoration:line-through}
.result-question li.other{color:var(--text);opacity:.7;text-decoration:line-through}
.result-question .explanation{margin-top:8px;font-size:14px;color:var(--muted);border-left:3px solid var(--accent);padding-left:10px}

/* Sombre : contraste score & message final */
:root[data-theme="dark"] .score{
  background: linear-gradient(
    180deg,
    color-mix(in oklab, var(--surface) 85%, black 15%),
    color-mix(in oklab, var(--surface) 70%, var(--primary) 30%)
  );
  color: var(--text);
  border-color: rgba(255,255,255,.10);
}
:root[data-theme="dark"] .final-card{
  background: linear-gradient(
    180deg,
    color-mix(in oklab, var(--surface) 90%, black 10%),
    color-mix(in oklab, var(--surface) 75%, var(--primary-2) 25%)
  );
  border-color: rgba(255,255,255,.10);
}
:root[data-theme="dark"] .final-msg-text{ color: var(--text); }
:root[data-theme="dark"] .final-msg-link{ color: var(--primary-2); text-decoration: underline; }

/* ===== Nav questions : Valider proche, Précédent éloigné ===== */
.nav{
  display:grid;
  grid-template-columns:1fr 1fr;
  grid-template-areas:
    "validate ."
    ". prev";
  gap:14px 16px;
  margin-top:14px;
}
.nav-validate{ grid-area: validate; justify-self:start; }
.nav-prev{ grid-area: prev; justify-self:end; transform: translateY(2px); }

/* ===== Landing mode lecteur (hero) ===== */
.reader-mode #screen-import{ display:grid; gap:20px; }
.reader-hero{ display:grid; place-items:center; text-align:center; padding:12px 0 6px; }
.reader-hero .hero-title{
  font-size: clamp(28px, 5vw, 44px); font-weight:800; margin:4px 0 10px; letter-spacing:.2px;
  animation: wowFade .5s ease-out both;
}
.reader-hero .hero-card{
  background: linear-gradient(180deg, #fff, color-mix(in oklab, #fff 70%, var(--primary-2) 30%));
  border:1px solid var(--border); border-radius:20px; padding:16px 22px;
  box-shadow:0 18px 46px var(--shadow); min-width:min(560px, 92%);
  animation: wowPop .5s .06s cubic-bezier(.22,.75,.16,1) both;
}
.reader-hero .hero-quiz-title{ font-size: clamp(18px, 2.6vw, 22px); font-weight:700; color:var(--text); }
.reader-mode .import-actions{ display:flex; justify-content:center; margin-top:8px; }
.reader-mode #btnStart{
  font-size: clamp(18px, 2.6vw, 22px); padding:16px 28px; border-radius:16px; min-width:min(360px, 90%);
  box-shadow: 0 0 0 0 rgba(96,128,191,.0);
  animation: wowPop .5s .1s cubic-bezier(.22,.75,.16,1) both;
}
.reader-mode #btnStart:hover{
  transform: translateY(-1px);
  box-shadow: 0 12px 30px rgba(96,128,191,.35), 0 0 0 6px color-mix(in oklab, var(--primary) 24%, transparent);
}

@keyframes wowFade{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
@keyframes wowPop{from{opacity:0;transform:scale(.96)}to{opacity:1;transform:scale(1)}}

/* ===== Footer & Responsive ===== */
.app-footer{color:var(--muted);font-size:12px;text-align:center;padding-bottom:28px}

@media (max-width:800px){
  .results-top{grid-template-columns:1fr}
  .score-wrap{justify-content:start}
}
@media (max-width:640px){
  .app,.app-header,.app-footer{padding:16px}
  .screen{padding:18px;border-radius:18px}

  /* Mobile : lisibilité + touch-friendly */
  #question-title{font-size:22px}
  .answer-btn{font-size:18px; padding:16px 16px}
  .short-answer-input{font-size:18px; padding:14px}
  .btn{width:100%; font-size:16px; padding:14px 16px}

  /* Nav empilée */
  .nav{
    grid-template-columns:1fr;
    grid-template-areas: "validate" "prev";
    gap:12px;
  }
  .nav-validate,.nav-prev{ justify-self:stretch; }
}
